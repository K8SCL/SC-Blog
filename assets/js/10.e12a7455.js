(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{326:function(t,s,a){"use strict";a.r(s);var n={async mounted(){document.querySelector("#master-api-xmind");const t=await fetch("/assets/xmind/k8s/k8s源码之旅/Master装载API.xmind");new XMindEmbedViewer({el:"#master-api-xmind",file:await t.arrayBuffer(),styles:{height:"600px",width:"100%"},zoomScale:80})}},e=a(3),r=function(t){t.options.__data__block__={mermaid_64a56fae:'graph LR\n    A("Options") --\x3e B("Config")\n    B --\x3e C("API Server 实例")\n',mermaid_64a56fac:"stateDiagram\n    START --\x3e cmd/kube_apiserver/apiserver.go\n    cmd/kube_apiserver/apiserver.go --\x3e vendor/k8s.io/component_base/cli/run.go\n    state cmd/kube_apiserver/apiserver.go {\n\n      main() --\x3e app.NewAPIServerCommand()\n      app.NewAPIServerCommand()  --\x3e cli.Run(command)\n      state app.NewAPIServerCommand() {\n        option -- flags\n      }\n\n    }\n    vendor/k8s.io/component_base/cli/run.go\n    state vendor/k8s.io/component_base/cli/run.go {\n      Run() --\x3e run()\n      state run() {\n         cmd.Execute()\n      }\n    }\n",mermaid_64a56fa4:'graph LR\n    A("Aggregation Server") --\x3e B("Master")\n    B --\x3e C("Extebsion Server")\n\tC --\x3e D("Not Found Handler")\n',mermaid_64a56920:"stateDiagram\n    [*] --\x3e RunE\n    RunE --\x3e vendor/k8s.io/component_base/cli/run.go\n    state RunE {\n        Complete()__填充默认值--\x3eValidate()__校验completedOptions\n        Validate()__校验completedOptions--\x3eRun()\n        state Run(){\n            CreateServerChain()  --\x3e PrepareRun()\n            state CreateServerChain(){\n                CreateKubeAPIServerConfig()--\x3ecreateAPIExtensionsConfig()\n                createAPIExtensionsConfig()--\x3enotfoundhandler.New()\n                notfoundhandler.New()--\x3eCreateKubeAPIServer()\n                CreateKubeAPIServer()--\x3ecreateAggregatorConfig()\n                createAggregatorConfig()--\x3ecreateAggregatorServer()\n                createAggregatorServer()--\x3ereturn__aggregatorServer\n\n            }\n            PrepareRun()--\x3eprepared.Run\n        }\n    }\n"}},o=Object(e.a)(n,(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"视频地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#视频地址"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://www.bilibili.com/video/BV13A4y1R7RH?p=1&vd_source=62e2bbc859564f43d9cc06ff317aaa5e",target:"_blank",rel:"noopener noreferrer"}},[t._v("视频地址"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"准备工作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[t._v("#")]),t._v(" 准备工作")]),t._v(" "),s("ul",[s("li",[t._v("推荐书籍")])]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"image","data-src":"https://cdn.staticaly.com/gh/brook-w/image-hosting@master/k8s/image.krjzhoeno9s.webp",loading:"lazy"}})]),t._v(" "),s("h3",{attrs:{id:"目录梳理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#目录梳理"}},[t._v("#")]),t._v(" 目录梳理")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("./cmd/kube-apiserver")])]),t._v(" "),s("blockquote",[s("p",[t._v("API Server 可执行程序的主入口，基于 cobra，主要负责接受命令行参数，也是代码学习的入口")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("./vendor/k8s.io")]),t._v(" 和 "),s("code",[t._v("./staging/src/k8s.io")])]),t._v(" "),s("blockquote",[s("p",[t._v("vendor 机制是老一代版本依赖管理机制，module 是新一代。不过 vendor 目录存在还是会被优先使用；staging 中包含正在被单独抽离的组件，软引用到 vendor 下")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("./pkg")])]),t._v(" "),s("blockquote",[s("p",[t._v("大部分源码所在地，除了被抽离为单独组件的部分，例如 api-server 的代码，proxy 相关的代码，kubelet 组件的代码等")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("./pkg/api")]),t._v("和"),s("code",[t._v("./pkg/apis")])]),t._v(" "),s("blockquote",[s("p",[t._v("api 文件下包含 OpenAPI 相关的模型定义等内容，用于根据 OpenAPI 规范形成符合规定的 API")])]),t._v(" "),s("blockquote",[s("p",[t._v("apis 是包含内建 API Groups 和 API Objects 的，和 scheme 相关的代码大部分在这里")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("./plugin")])]),t._v(" "),s("blockquote",[s("p",[t._v("Kubernetes 内建的 plugin 实现，包含 admission 和 auth 两个部分")])])])]),t._v(" "),s("h2",{attrs:{id:"api-server-启动过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#api-server-启动过程"}},[t._v("#")]),t._v(" API Server 启动过程")]),t._v(" "),s("p",[s("strong",[t._v("重点")])]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("API Object")])]),t._v(" "),s("blockquote",[s("p",[t._v("Kubernetes 内部管理的基本元素，是 k8s 在 ETCD 中信息存储单元。")]),t._v(" "),s("p",[t._v('例如：Deployment、Pod、Service 都是 API Object，代码内部也常用 "API" 来称呼他们。')])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("API Group")])]),t._v(" "),s("blockquote",[s("p",[t._v("一组 API Object 组成的一个具有共性的对象集合。")]),t._v(" "),s("p",[t._v("例如：apps 这个 group 它是由 Deployment、ReplicaSet、StatefulSet 等 API Object 组成的")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("Legacy API Object")])]),t._v(" "),s("blockquote",[s("p",[t._v("绝大多数的 API Object 都被归在某个 API Group 下面，特别是新版本引入的一定会遵从这一原则，但在 k8s 项目初始化阶段引入的 API Object 没有显示定义在 API Group。例如 Pod")]),t._v(" "),s("p",[t._v('Event、Node 等。在代码中有时也称呼他们为 "core" API Object')])])])]),t._v(" "),s("p",[s("strong",[s("a",{attrs:{href:"https://brook-w.com/pages/b4af77/",target:"_blank",rel:"noopener noreferrer"}},[t._v("了解 Cobra"),s("OutboundLink")],1)])]),t._v(" "),s("details",{staticClass:"custom-block details"},[s("summary",[t._v("示例 （kube-apiserver）")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewAPIServerCommand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("cobra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Command "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\ts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewServerRunOptions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tcmd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("cobra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tUse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kube-apiserver"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\tLong"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("`The Kubernetes API server validates and configures data\nfor the api objects which include pods, services, replicationcontrollers, and\nothers. The API Server services REST operations and provides the frontend to the\ncluster's shared state through which all other components interact.`")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// stop printing usage when the command errors")]),t._v("\n\t\tSilenceUsage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\tPersistentPreRunE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("cobra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// silence client-go warnings.")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// kube-apiserver loopback clients should not log self-issued warnings.")]),t._v("\n\t\t\trest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("SetDefaultWarningHandler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NoWarnings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\tRunE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cmd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("cobra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tverflag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("PrintAndExitIfRequested")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\tfs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" cmd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Activate logging as soon as possible, after that")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// show flags with the final logging configuration.")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Logs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ValidateAndApply")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("utilfeature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DefaultFeatureGate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" err\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\tcliflag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("PrintFlags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// set default options")]),t._v("\n\t\t\tcompletedOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Complete")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" err\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// validate options")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" errs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" completedOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Validate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("errs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" utilerrors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewAggregate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("errs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("completedOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" genericapiserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("SetupSignalHandler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\tArgs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cmd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("cobra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" arg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("range")]),t._v(" args "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" fmt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Errorf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%q does not take any arguments, got %q"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cmd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CommandPath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\tfs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" cmd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tnamedFlagSets "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tverflag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddFlags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("namedFlagSets"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("FlagSet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"global"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tglobalflag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddGlobalFlags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("namedFlagSets"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("FlagSet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"global"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cmd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" logs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("SkipLoggingConfigurationFlags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\toptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddCustomGlobalFlags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("namedFlagSets"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("FlagSet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"generic"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" f "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("range")]),t._v(" namedFlagSets"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FlagSets "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tfs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddFlagSet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\tcols"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("_")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" term"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("TerminalSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cmd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("OutOrStdout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tcliflag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("SetUsageAndHelpFunc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cmd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" namedFlagSets"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cols"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" cmd\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("h3",{attrs:{id:"代码预览"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码预览"}},[t._v("#")]),t._v(" 代码预览")]),t._v(" "),s("h4",{attrs:{id:"目录结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("tree cmd/kube-apiserver\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n├── apiserver.go\n├── app\n│   ├── aggregator.go\n│   ├── apiextensions.go\n│   ├── options\n│   │   ├── globalflags.go\n│   │   ├── globalflags_providerless.go\n│   │   ├── globalflags_providers.go\n│   │   ├── globalflags_test.go\n│   │   ├── options.go\n│   │   ├── options_test.go\n│   │   ├── validation.go\n│   │   └── validation_test.go\n│   ├── server.go\n│   ├── server_test.go\n│   └── testing\n│       ├── testdata\n│       │   ├── "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1_10.0.0.1_kubernetes.default.svc-kubernetes.default-kubernetes-localhost.crt\n│       │   ├── "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1_10.0.0.1_kubernetes.default.svc-kubernetes.default-kubernetes-localhost.key\n│       │   └── README.md\n│       └── testserver.go\n└── OWNERS\n")])])]),s("h4",{attrs:{id:"主程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#主程序"}},[t._v("#")]),t._v(" 主程序")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// cmd/kube-apiserver/apiserver.go")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tcommand "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewAPIServerCommand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tcode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" cli"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"命令主体"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#命令主体"}},[t._v("#")]),t._v(" 命令主体")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// cmd/kube-apiserver/app/server.go")]),t._v("\ncmd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("cobra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Use Long 描述用途")]),t._v("\n\t\tUse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kube-apiserver"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\tLong"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("`The Kubernetes API server validates and configures data\nfor the api objects which include pods, services, replicationcontrollers, and\nothers. The API Server services REST operations and provides the frontend to the\ncluster's shared state through which all other components interact.`")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// stop printing usage when the command errors")]),t._v("\n\t\tSilenceUsage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在 Run 之前运行一些前置的指令，类似于拦截器")]),t._v("\n\t\tPersistentPreRunE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("cobra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// silence client-go warnings.")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// kube-apiserver loopback clients should not log self-issued warnings.")]),t._v("\n\t\t\trest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("SetDefaultWarningHandler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NoWarnings"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 最终执行的指令")]),t._v("\n\t\tRunE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cmd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("cobra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tverflag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("PrintAndExitIfRequested")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\tfs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" cmd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Flags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Activate logging as soon as possible, after that")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// show flags with the final logging configuration.")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Logs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ValidateAndApply")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("utilfeature"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DefaultFeatureGate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" err\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\tcliflag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("PrintFlags")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// set default options")]),t._v("\n\t\t\tcompletedOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Complete")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" err "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" err\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// validate options")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" errs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" completedOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Validate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("errs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" utilerrors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("NewAggregate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("errs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("completedOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" genericapiserver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("SetupSignalHandler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 检验 args 是否满足需求")]),t._v("\n\t\tArgs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cmd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("cobra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("error")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" arg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("range")]),t._v(" args "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" fmt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Errorf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%q does not take any arguments, got %q"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cmd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CommandPath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("nil")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"调用流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调用流程"}},[t._v("#")]),t._v(" 调用流程")]),t._v(" "),s("h5",{attrs:{id:"基本启动流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本启动流程"}},[t._v("#")]),t._v(" 基本启动流程")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/kubernetes/kubernetes/blob/v1.24.0/cmd/kube-apiserver/apiserver.go",target:"_blank",rel:"noopener noreferrer"}},[t._v("cmd/kube-apiserver/app/server.go"),s("OutboundLink")],1)]),t._v(" "),s("Mermaid",{attrs:{id:"mermaid_64a56fae",graph:t.$dataBlock.mermaid_64a56fae}}),s("Mermaid",{attrs:{id:"mermaid_64a56fac",graph:t.$dataBlock.mermaid_64a56fac}}),s("p",[s("strong",[t._v("Server Chain")])]),t._v(" "),s("Mermaid",{attrs:{id:"mermaid_64a56fa4",graph:t.$dataBlock.mermaid_64a56fa4}}),s("ul",[s("li",[t._v("Aggregation Server\n"),s("blockquote",[s("p",[t._v("负责转发请求到 Master 或 Custom API Server")])])]),t._v(" "),s("li",[t._v("Master\n"),s("blockquote",[s("p",[t._v("Kube API Server，负责 Build-in 的 API Object 相关的处理")]),t._v(" "),s("p",[t._v("例如：Pod，Event，apps ...")])])]),t._v(" "),s("li",[t._v("Extebsion Server\n"),s("blockquote",[s("p",[t._v("Customer Resource 的处理由它完成，包括 CR 和 CRD")])])]),t._v(" "),s("li",[t._v("Not Found Handler\n"),s("blockquote",[s("p",[t._v("找不到相应的 API Object 的时候，返回 404")])])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("在真正构建的时候会生成一个 pipeline 是从右向左，依次构建，当前层处理不了的请求流向下一层，直到 "),s("code",[t._v("Not Found Handler")])])]),t._v(" "),s("h5",{attrs:{id:"rune-启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rune-启动"}},[t._v("#")]),t._v(" RunE 启动")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/kubernetes/kubernetes/blob/v1.24.0/cmd/kube-apiserver/app/server.go",target:"_blank",rel:"noopener noreferrer"}},[t._v("cmd/kube-apiserver/app/server.go"),s("OutboundLink")],1)]),t._v(" "),s("Mermaid",{attrs:{id:"mermaid_64a56920",graph:t.$dataBlock.mermaid_64a56920}}),s("h5",{attrs:{id:"master-中装载-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#master-中装载-api"}},[t._v("#")]),t._v(" Master 中装载 API")]),t._v(" "),s("p",[t._v('API Server 的 "内容" 是 API Object，通过 Restful 服务对外提供操作 API Object 的能力')]),t._v(" "),s("p",[t._v("那么 API Server 是如何建立起针对各个 API Object 的服务呢？")]),t._v(" "),s("div",{attrs:{id:"master-api-xmind"}}),t._v(" "),s("h2",{attrs:{id:"scheme-详解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#scheme-详解"}},[t._v("#")]),t._v(" Scheme 详解")]),t._v(" "),s("h3",{attrs:{id:"构造并填充-scheme"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构造并填充-scheme"}},[t._v("#")]),t._v(" 构造并填充 Scheme")]),t._v(" "),s("p",[t._v("Scheme: 存储当前 API Server 知道的 API Group (类似于 Windows 注册表)")]),t._v(" "),s("p",[s("strong",[t._v("Scheme 是如何填充的呢？")])]),t._v(" "),s("ClientOnly",[s("DrawioComponent",{attrs:{src:"https://cdn.staticaly.com/gh/brook-w/image-hosting@master/k8s/xmind/api-server-scheme.drawio"}})],1),t._v(" "),s("ClientOnly",[s("DrawioComponent",{attrs:{src:"https://cdn.staticaly.com/gh/brook-w/image-hosting@master/k8s/xmind/api-server-scheme-fill.drawio"}})],1),t._v(" "),s("h3",{attrs:{id:"概念词组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概念词组"}},[t._v("#")]),t._v(" 概念词组")]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("Version")])]),t._v(" "),s("blockquote",[s("p",[t._v("每个 API Group 都会有一个 version。每一个 version 会包含多个 kind (一个 kind 会出现在多个 version 下)")]),t._v(" "),s("p",[t._v("这些 Version 又称为 External Version，他们面向 API Server 外部")]),t._v(" "),s("p",[t._v("Internal Version 是 API Server 在内部程序中处理数据时对 API Object 的实际类型")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("GVK")])]),t._v(" "),s("blockquote",[s("p",[t._v("Group、Veersion、Kind 这三个元素唯一确定了一个 Kind。程序中，GVK 可以理解为一个字符串，三者拼接的结果（程序中是一个含三字段的结构体）")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v('"Type"')])]),t._v(" "),s("blockquote",[s("p",[t._v('代码中常见的 "Type"，例如 gvk2Type 字段。这里的 Type 是一个 API Object 结构体类型（元数据），是程序中处理一个 Object 时使用的数据结构')])])])]),t._v(" "),s("h3",{attrs:{id:"scheme-作用和应用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#scheme-作用和应用场景"}},[t._v("#")]),t._v(" Scheme 作用和应用场景")]),t._v(" "),s("p",[s("strong",[t._v("Scheme 是一个结构体，内含处理内外部 Version 之间的转换，GVK 和 GoType 之间转换时用的数据和方法")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("GVK 与 Go Type 之间的转换")])]),t._v(" "),s("blockquote",[s("p",[t._v("Scheme 内部又两个 "),s("code",[t._v("map")]),t._v("，分别对应 gvk → type 和 type → gvk；使得二者可以互相找到")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("API Object 的默认值")])]),t._v(" "),s("blockquote",[s("p",[t._v("API Object 有许多属性，使用者在操作一个 object 时，不太可能给出所有的属性值；另外在 Object 从一个 Version 转换到另一个 Version 时也可能不需要为不存在对应关系的字段填值")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("内外部 Version 之间的 Convert")])]),t._v(" "),s("blockquote",[s("p",[t._v("所有外部的 Version 都会转换为 内部 Version，转换函数时记录在 Scheme 之内的")])])])]),t._v(" "),s("p",[s("strong",[t._v("Scheme 代码")])]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"image","data-src":"https://cdn.staticaly.com/gh/brook-w/image-hosting@master/k8s/image.1n3mk4u38iio.webp",loading:"lazy"}})]),t._v(" "),s("details",{staticClass:"custom-block details"},[s("summary",[t._v("Scheme 代码")]),t._v(" "),s("div",{staticClass:"language-go extra-class"},[s("pre",{pre:!0,attrs:{class:"language-go"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vendor/k8s.io/apimachinery/pkg/runtime/scheme.go")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),t._v(" Scheme "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// gvkToType allows one to figure out the go type of an object with")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the given version and name.")]),t._v("\n\tgvkToType "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GroupVersionKind"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("reflect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Type\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// typeToGVK allows one to find metadata for a given go object.")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The reflect.Type we index by should *not* be a pointer.")]),t._v("\n\ttypeToGVK "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("reflect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GroupVersionKind\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// unversionedTypes are transformed without conversion in ConvertToVersion.")]),t._v("\n\tunversionedTypes "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("reflect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GroupVersionKind\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// unversionedKinds are the names of kinds that can be created in the context of any group")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// or version")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// TODO: resolve the status of unversioned types.")]),t._v("\n\tunversionedKinds "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("reflect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Type\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Map from version and resource to the corresponding func to convert")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// resource field labels in that version to internal version.")]),t._v("\n\tfieldLabelConversionFuncs "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GroupVersionKind"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("FieldLabelConversionFunc\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// defaulterFuncs is a map to funcs to be called with an object to provide defaulting")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the provided object must be a pointer.")]),t._v("\n\tdefaulterFuncs "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("reflect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// converter stores all registered conversion functions. It also has")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// default converting behavior.")]),t._v("\n\tconverter "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("conversion"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Converter\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// versionPriority is a map of groups to ordered lists of versions for those groups indicating the")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// default priorities of these versions as registered in the scheme")]),t._v("\n\tversionPriority "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// observedVersions keeps track of the order we've seen versions during type registration")]),t._v("\n\tobservedVersions "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GroupVersion\n\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// schemeName is the name of this scheme.  If you don't specify a name, the stack of the NewScheme caller will be used.")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// This is useful for error reporting to indicate the origin of the scheme.")]),t._v("\n\tschemeName "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("h3",{attrs:{id:"填充-scheme-代码-internal-version"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#填充-scheme-代码-internal-version"}},[t._v("#")]),t._v(" 填充 Scheme 代码 —— Internal Version")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"image","data-src":"https://cdn.staticaly.com/gh/brook-w/image-hosting@master/k8s/image.2ubjfbnciqg.webp",loading:"lazy"}})]),t._v(" "),s("h3",{attrs:{id:"填充-scheme-代码-external-version"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#填充-scheme-代码-external-version"}},[t._v("#")]),t._v(" 填充 Scheme 代码 —— External Version")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"image","data-src":"https://cdn.staticaly.com/gh/brook-w/image-hosting@master/k8s/image.1tgr339c2veo.webp",loading:"lazy"}})]),t._v(" "),s("h3",{attrs:{id:"converter-和-defaulter-的代码生成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#converter-和-defaulter-的代码生成"}},[t._v("#")]),t._v(" Converter 和 Defaulter 的代码生成")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"image","data-src":"https://cdn.staticaly.com/gh/brook-w/image-hosting@master/k8s/image.4sfz3kpn7t60.webp",loading:"lazy"}})]),t._v(" "),s("h2",{attrs:{id:"generic-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generic-server"}},[t._v("#")]),t._v(" Generic Server")]),t._v(" "),s("h2",{attrs:{id:"master-api-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#master-api-server"}},[t._v("#")]),t._v(" Master API Server")]),t._v(" "),s("h2",{attrs:{id:"extension-api-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#extension-api-server"}},[t._v("#")]),t._v(" Extension API Server")]),t._v(" "),s("h2",{attrs:{id:"aggreator-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#aggreator-server"}},[t._v("#")]),t._v(" Aggreator Server")]),t._v(" "),s("h2",{attrs:{id:"admission"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#admission"}},[t._v("#")]),t._v(" Admission")]),t._v(" "),s("h2",{attrs:{id:"default-filters-and-http-request"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#default-filters-and-http-request"}},[t._v("#")]),t._v(" Default Filters and Http Request")]),t._v(" "),s("h2",{attrs:{id:"登录与鉴权的实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#登录与鉴权的实现"}},[t._v("#")]),t._v(" 登录与鉴权的实现")])],1)}),[],!1,null,null,null);"function"==typeof r&&r(o);s.default=o.exports}}]);