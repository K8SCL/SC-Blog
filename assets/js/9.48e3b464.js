(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{331:function(t,s,a){"use strict";a.r(s);var e=a(3),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"视频地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#视频地址"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://www.bilibili.com/video/BV1JY4y1V7hj/?spm_id_from=333.999.0.0&vd_source=62e2bbc859564f43d9cc06ff317aaa5e",target:"_blank",rel:"noopener noreferrer"}},[t._v("视频地址"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"编译和启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编译和启动"}},[t._v("#")]),t._v(" 编译和启动")]),t._v(" "),s("h3",{attrs:{id:"_1-编译"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-编译"}},[t._v("#")]),t._v(" 1. 编译")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$GOPATH")]),t._v("/src/k8s.io/kubernetes\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 编译单个组建：")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("WHAT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cmd/kube-apiserver"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 编译所有组件：")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" all\n\n")])])]),s("h3",{attrs:{id:"_2-启动本地单节点集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-启动本地单节点集群"}},[t._v("#")]),t._v(" 2. 启动本地单节点集群")]),t._v(" "),s("h4",{attrs:{id:"_1-启动集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-启动集群"}},[t._v("#")]),t._v(" 1. 启动集群")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$GOPATH")]),t._v("/src/k8s.io/kubernetes\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" clean "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" all "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可选")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ./hack/local-up-cluster.sh\n")])])]),s("details",{staticClass:"custom-block details"},[s("summary",[t._v("启动的正常输出")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("make: 进入目录“/home/xing/go/src/k8s.io/kubernetes”\nmake"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": 进入目录“/home/xing/go/src/k8s.io/kubernetes”\n+++ "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1201")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":08:55"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Building go targets "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" linux/amd64\n    k8s.io/kubernetes/hack/make-rules/helpers/go2make "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("non-static"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmake"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": 离开目录“/home/xing/go/src/k8s.io/kubernetes”\n+++ "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1201")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:08"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Building go targets "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" linux/amd64\n    k8s.io/kubernetes/cmd/kubectl "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("static"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    k8s.io/kubernetes/cmd/kube-apiserver "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("static"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    k8s.io/kubernetes/cmd/kube-controller-manager "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("static"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    k8s.io/kubernetes/cmd/cloud-controller-manager "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("non-static"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    k8s.io/kubernetes/cmd/kubelet "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("non-static"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    k8s.io/kubernetes/cmd/kube-proxy "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("static"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    k8s.io/kubernetes/cmd/kube-scheduler "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("static"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmake: 离开目录“/home/xing/go/src/k8s.io/kubernetes”\nAPI SERVER secure port is free, proceeding"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nDetected "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("host")]),t._v(" and ready to start services.  Doing some housekeeping first"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nUsing GO_OUT /home/xing/go/src/k8s.io/kubernetes/_output/local/bin/linux/amd64\nStarting services now"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nStarting etcd\netcd --advertise-client-urls http://127.0.0.1:2379 --data-dir /tmp/tmp.LNJCC3Y7Wu --listen-client-urls http://127.0.0.1:2379 --log-level"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("warn "),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/tmp/etcd.log"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/dev/null\nWaiting "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" etcd to come up.\n+++ "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1201")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" On try "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(", etcd: "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"health"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"reason"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"header"')]),t._v(":"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cluster_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"14841639068965178418"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"member_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10276657743932975437"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"revision"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"raft_term"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("Generating a RSA private key\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".+++++\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".+++++\nwriting new private key to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/var/run/kubernetes/server-ca.key'")]),t._v("\n-----\nGenerating a RSA private key\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("+++++\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("+++++\nwriting new private key to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/var/run/kubernetes/client-ca.key'")]),t._v("\n-----\nGenerating a RSA private key\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".+++++\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".+++++\nwriting new private key to "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/var/run/kubernetes/request-header-ca.key'")]),t._v("\n-----\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generate received request\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" received CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generating key: rsa-2048\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" encoded CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" signed certificate with serial number "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("293151017665098086348880715532871957730156180132")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generate received request\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" received CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generating key: rsa-2048\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" encoded CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" signed certificate with serial number "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("487348345664182233435909206222659454057143719021")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generate received request\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" received CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:45 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generating key: rsa-2048\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" encoded CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" signed certificate with serial number "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("195819653141672173053279722256472095709163847153")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generate received request\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" received CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generating key: rsa-2048\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" encoded CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" signed certificate with serial number "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("613544450701441397610845302043050839746564066359")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generate received request\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" received CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generating key: rsa-2048\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" encoded CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" signed certificate with serial number "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("115061008643950752125067148135424784083397571613")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generate received request\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" received CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generating key: rsa-2048\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" encoded CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" signed certificate with serial number "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("584615864316512973410633747924687800725528845655")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generate received request\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" received CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generating key: rsa-2048\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" encoded CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" signed certificate with serial number "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("571089137347621389894999036328721562159155378791")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generate received request\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" received CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:46 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generating key: rsa-2048\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:47 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" encoded CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:47 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" signed certificate with serial number "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("153203515574633399568421412669629167562151942413")]),t._v("\nWaiting "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" apiserver to come up\n+++ "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1201")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":09:52"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" On try "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(", apiserver: "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" ok\nclusterrolebinding.rbac.authorization.k8s.io/kube-apiserver-kubelet-admin created\nclusterrolebinding.rbac.authorization.k8s.io/kubelet-csr created\nCluster "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-up-cluster"')]),t._v(" set.\nuse "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'kubectl --kubeconfig=/var/run/kubernetes/admin-kube-aggregator.kubeconfig'")]),t._v(" to use the aggregated API server\nserviceaccount/coredns created\nclusterrole.rbac.authorization.k8s.io/system:coredns created\nclusterrolebinding.rbac.authorization.k8s.io/system:coredns created\nconfigmap/coredns created\ndeployment.apps/coredns created\nservice/kube-dns created\ncoredns addon successfully deployed.\nChecking CNI Installation at /opt/cni/bin\nCNI Installation not found at /opt/cni/bin\nCNI_PLUGINS_URL:https://ghps.cc/https://github.com/containernetworking/plugins/releases/download/v1.0.1/cni-plugins-linux-amd64-v1.0.1.tgz\nInstalling CNI plugin binaries "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n5238fbb2767cbf6aae736ad97a7aa29167525dcd405196dfbc064672a730d3cf  /tmp/cni.amd64.tgz\n/tmp/cni.amd64.tgz: 成功\n./\n./macvlan\n./static\n./vlan\n./portmap\n./host-local\n./vrf\n./bridge\n./tuning\n./firewall\n./host-device\n./sbr\n./loopback\n./dhcp\n./ptp\n./ipvlan\n./bandwidth\nConfiguring cni\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cniVersion"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0.4.0"')]),t._v(",\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"containerd-net"')]),t._v(",\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plugins"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bridge"')]),t._v(",\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bridge"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cni0"')]),t._v(",\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"isGateway"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" true,\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ipMasq"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" true,\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"promiscMode"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" true,\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ipam"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"host-local"')]),t._v(",\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ranges"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"subnet"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10.88.0.0/16"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"subnet"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2001:4860:4860::/64"')]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(",\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"routes"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dst"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0.0.0.0/0"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dst"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"::/0"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"portmap"')]),t._v(",\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"capabilities"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"portMappings"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nWARNING "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" The kubelet is configured to not fail even "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" swap is enabled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" production deployments should disable swap unless testing NodeSwap feature.\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":10:00 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generate received request\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":10:00 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" received CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":10:00 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generating key: rsa-2048\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":10:00 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" encoded CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":10:00 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" signed certificate with serial number "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("421978020129055193511090121764118686933107812863")]),t._v("\nkubelet "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("304932")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" is running.\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),t._v(" kubelet ready\nNo resources found\nNo resources found\nNo resources found\nNo resources found\nNo resources found\nNo resources found\nNo resources found\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1   NotReady   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("   2s    v1.24.0-dirty\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":10:16 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generate received request\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":10:16 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" received CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":10:16 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" generating key: rsa-2048\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":10:16 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" encoded CSR\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("/12/01 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":10:16 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" signed certificate with serial number "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("592457083326791792374452832572534131669724027176")]),t._v("\nCreate default storage class "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v("\nstorageclass.storage.k8s.io/standard created\nLocal Kubernetes cluster is running. Press Ctrl-C to shut it down.\n\nLogs:\n  /tmp/kube-apiserver.log\n  /tmp/kube-controller-manager.log\n\n  /tmp/kube-proxy.log\n  /tmp/kube-scheduler.log\n  /tmp/kubelet.log\n\nTo start using your cluster, you can "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v(" up another terminal/tab and run:\n\n  "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("KUBECONFIG")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/admin.kubeconfig\n  cluster/kubectl.sh\n\nAlternatively, you can "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),t._v(" to the default kubeconfig:\n\n  "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("KUBERNETES_PROVIDER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("local\n\n  cluster/kubectl.sh config set-cluster "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--server")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://localhost:6443 --certificate-authority"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/server-ca.crt\n  cluster/kubectl.sh config set-credentials myself --client-key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-admin.key --client-certificate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-admin.crt\n  cluster/kubectl.sh config set-context "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--cluster")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("local "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--user")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("myself\n  cluster/kubectl.sh config use-context "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v("\n  cluster/kubectl.sh\n")])])])]),t._v(" "),s("h4",{attrs:{id:"_2-验证集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-验证集群"}},[t._v("#")]),t._v(" 2. 验证集群")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${GOPATH}")]),t._v("/src/k8s.io/kubernetes\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("KUBECONFIG")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/admin.kubeconfig\ncluster/kubectl.sh get nodes\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Outpus:\nNAME        STATUS   ROLES    AGE    VERSION\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1   Ready    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("   5m3s   v1.24.0-dirty\n")])])]),s("p",[t._v("部署资源")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /home/${USER}/kube/yaml/test.yaml")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Pod\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" daocloud.io/library/nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("1.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("alpine\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containerPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" /home/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${"),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),t._v("}")]),t._v("/kube/yaml\ncluster/kubectl.sh create "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" /home/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${"),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),t._v("}")]),t._v("/kube/yaml/test.yaml\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Outputs:\npod/nginx created\n\ncluster/kubectl.sh get po\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Outputs:\nNAME    READY   STATUS              RESTARTS   AGE\nnginx   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("/1     ContainerCreating   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          70s\n")])])]),s("h3",{attrs:{id:"_3-启动过程中遇到的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-启动过程中遇到的问题"}},[t._v("#")]),t._v(" 3. 启动过程中遇到的问题")]),t._v(" "),s("h4",{attrs:{id:"_1-cni-下载不下来"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-cni-下载不下来"}},[t._v("#")]),t._v(" 1. cni 下载不下来")]),t._v(" "),s("p",[t._v("替换 "),s("code",[t._v("local-up-cluster.sh")]),t._v(" 中的变量 "),s("code",[t._v("CNI_PLUGINS_URL")])]),t._v(" "),s("p",[t._v("也可以自己下载下来放到指定目录")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("CNI_PLUGINS_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://ghps.cc/https://github.com/containernetworking/plugins/releases/download/'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CNI_PLUGINS_TARBALL}")]),t._v('"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# CNI_PLUGINS_URL="https://github.com/containernetworking/plugins/releases/download/${CNI_PLUGINS_TARBALL}"')]),t._v("\n")])])]),s("h2",{attrs:{id:"调试源码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调试源码"}},[t._v("#")]),t._v(" 调试源码")]),t._v(" "),s("h3",{attrs:{id:"_1-开启编译选项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-开启编译选项"}},[t._v("#")]),t._v(" 1. 开启编译选项")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$GOPATH")]),t._v("/src/k8s.io/kubernetes\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" ./hack/lib/golang.sh\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查找build_binaries()函数 vi语法")]),t._v("\n:/build_binaries"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("gogcflags")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"all=-trimpath='),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${trimroot}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${GOGCFLAGS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":-")]),t._v("}")]),t._v('"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${DBG"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":-")]),t._v("}")]),t._v('"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Debugging - disable optimizations and inlining.")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("gogcflags")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${gogcflags}")]),t._v(' -N -l"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("goldflags")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"all='),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("kube::version::ldflags"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${GOLDFLAGS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":-")]),t._v("}")]),t._v('"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${DBG"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":-")]),t._v("}")]),t._v('"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Not debugging - disable symbols and DWARF.")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("goldflags")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${goldflags}")]),t._v(' -s -w"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n")])])]),s("p",[t._v("替换为")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("gogcflags")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"all=-trimpath='),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${trimroot}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${GOGCFLAGS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":-")]),t._v("}")]),t._v('"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# if [[ "${DBG:-}" == 1 ]]; then')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     # Debugging - disable optimizations and inlining.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#     gogcflags="${gogcflags} -N -l"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# fi")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("gogcflags")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${gogcflags}")]),t._v(' -N -l"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("goldflags")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"all='),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("kube::version::ldflags"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${GOLDFLAGS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":-")]),t._v("}")]),t._v('"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# if [[ "${DBG:-}" != 1 ]]; then')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     # Not debugging - disable symbols and DWARF.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#     goldflags="${goldflags} -s -w"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# fi")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-安装-dlv"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装-dlv"}},[t._v("#")]),t._v(" 2. 安装 "),s("a",{attrs:{href:"https://github.com/go-delve/delve",target:"_blank",rel:"noopener noreferrer"}},[t._v("dlv"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/go-delve/delve\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" delve\ngo "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" github.com/go-delve/delve/cmd/dlv\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("注")]),t._v(" "),s("p",[t._v("这里我使用了 vscode go Tools 提供的套件")])]),t._v(" "),s("h3",{attrs:{id:"_3-调试-均支持远程调试-api-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-调试-均支持远程调试-api-server"}},[t._v("#")]),t._v(" 3. 调试（均支持远程调试）（api-server）")]),t._v(" "),s("h4",{attrs:{id:"_0-调试环境准备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_0-调试环境准备"}},[t._v("#")]),t._v(" 0. 调试环境准备")]),t._v(" "),s("h5",{attrs:{id:"_1-获取启动参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-获取启动参数"}},[t._v("#")]),t._v(" 1. 获取启动参数")]),t._v(" "),s("p",[s("u",[t._v("后面 dlv 需要这些参数")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-ef")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v("  kube-apiserver\n\n/home/xing/go/src/k8s.io/kubernetes/_output/local/bin/linux/amd64/kube-apiserver --authorization-mode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Node,RBAC  --cloud-provider"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --cloud-config"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--v")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--vmodule")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --audit-policy-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-audit-policy-file --audit-log-path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-apiserver-audit.log --authorization-webhook-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --authentication-token-webhook-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --cert-dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes --egress-selector-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube_egress_selector_configuration.yaml --client-ca-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-ca.crt --kubelet-client-certificate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-kube-apiserver.crt --kubelet-client-key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-kube-apiserver.key --service-account-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-serviceaccount.key --service-account-lookup"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true --service-account-issuer"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://kubernetes.default.svc --service-account-jwks-uri"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://kubernetes.default.svc/openid/v1/jwks --service-account-signing-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-serviceaccount.key --enable-admission-plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,Priority,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota,NodeRestriction --disable-admission-plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --admission-control-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --bind-address"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0 --secure-port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6443")]),t._v(" --tls-cert-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/serving-kube-apiserver.crt --tls-private-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/serving-kube-apiserver.key --storage-backend"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("etcd3 --storage-media-type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("application/vnd.kubernetes.protobuf --etcd-servers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://127.0.0.1:2379 --service-cluster-ip-range"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.0")]),t._v(".0.0/24 --feature-gates"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("AllAlpha"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false --external-hostname"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("localhost --requestheader-username-headers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("X-Remote-User --requestheader-group-headers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("X-Remote-Group --requestheader-extra-headers-prefix"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("X-Remote-Extra- --requestheader-client-ca-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/request-header-ca.crt --requestheader-allowed-names"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("system:auth-proxy --proxy-client-cert-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-auth-proxy.crt --proxy-client-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-auth-proxy.key --cors-allowed-origins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/127.0.0.1(:[0-9]+)?$,/localhost(:[0-9]+)?$"')]),t._v("\n")])])]),s("h5",{attrs:{id:"_2-杀掉-kube-apiserver"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-杀掉-kube-apiserver"}},[t._v("#")]),t._v(" 2. 杀掉 "),s("code",[t._v("kube-apiserver")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-9")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("378253")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里替换你的 kube-apiserver pid")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这时候集群会报警告信息出来")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Outputs:\nW1201 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(":13:25"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": API server terminated unexpectedly, see /tmp/kube-apiserver.log\n")])])]),s("h4",{attrs:{id:"_1-利用-vscode-进行代码调试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-利用-vscode-进行代码调试"}},[t._v("#")]),t._v(" 1. 利用 "),s("code",[t._v("vscode")]),t._v(" 进行代码调试")]),t._v(" "),s("h5",{attrs:{id:"_1-以-dlv-方式启动-kube-apiserver"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-以-dlv-方式启动-kube-apiserver"}},[t._v("#")]),t._v(" 1. 以 dlv 方式启动 kube-apiserver")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" dlv "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--headless")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exec")]),t._v(" /home/xing/go/src/k8s.io/kubernetes/_output/local/bin/linux/amd64/kube-apiserver   --api-version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" --only-same-user"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false  -- --authorization-mode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Node,RBAC  --cloud-provider"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --cloud-config"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--v")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--vmodule")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --audit-policy-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-audit-policy-file --audit-log-path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-apiserver-audit.log --authorization-webhook-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --authentication-token-webhook-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --cert-dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes --egress-selector-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube_egress_selector_configuration.yaml --client-ca-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-ca.crt --kubelet-client-certificate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-kube-apiserver.crt --kubelet-client-key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-kube-apiserver.key --service-account-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-serviceaccount.key --service-account-lookup"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true --service-account-issuer"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://kubernetes.default.svc --service-account-jwks-uri"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://kubernetes.default.svc/openid/v1/jwks --service-account-signing-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-serviceaccount.key --enable-admission-plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,Priority,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota,NodeRestriction --disable-admission-plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --admission-control-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --bind-address"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0 --secure-port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6443")]),t._v(" --tls-cert-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/serving-kube-apiserver.crt --tls-private-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/serving-kube-apiserver.key --storage-backend"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("etcd3 --storage-media-type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("application/vnd.kubernetes.protobuf --etcd-servers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://127.0.0.1:2379 --service-cluster-ip-range"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.0")]),t._v(".0.0/24 --feature-gates"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("AllAlpha"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false --external-hostname"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("localhost --requestheader-username-headers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("X-Remote-User --requestheader-group-headers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("X-Remote-Group --requestheader-extra-headers-prefix"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("X-Remote-Extra- --requestheader-client-ca-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/request-header-ca.crt --requestheader-allowed-names"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("system:auth-proxy --proxy-client-cert-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-auth-proxy.crt --proxy-client-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-auth-proxy.key --cors-allowed-origins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/127.0.0.1(:[0-9]+)?$,/localhost(:[0-9]+)?$"')]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注：如果指定了 --listen 就是你指定的 如果没有指定则随机生成一个端口 这里我是随机生成")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Outputs:\nAPI server listening at: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1:43605\n\n")])])]),s("h5",{attrs:{id:"_2-生成配置文件-不会百度或者复制下面即可"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-生成配置文件-不会百度或者复制下面即可"}},[t._v("#")]),t._v(" 2. 生成配置文件（不会百度或者复制下面即可）")]),t._v(" "),s("p",[t._v("用 "),s("code",[t._v("vscode")]),t._v(" 打开源码")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// .vscode/launch.json")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用 IntelliSense 了解相关属性。")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 悬停以查看现有属性的描述。")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0.2.0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"configurations"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Connect to server"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"go"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"request"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"attach"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"mode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"remote"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"remotePath"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"${workspaceFolder}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"port"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2345")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"host"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h5",{attrs:{id:"_3-开始调试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-开始调试"}},[t._v("#")]),t._v(" 3. 开始调试")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"image","data-src":"https://cdn.staticaly.com/gh/brook-w/image-hosting@master/k8s/image.4bbosnktb9m0.webp",loading:"lazy"}})]),t._v(" "),s("p",[s("em",[t._v("F5 执行")])]),t._v(" "),s("h5",{attrs:{id:"_4-成功执行调试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-成功执行调试"}},[t._v("#")]),t._v(" 4. 成功执行调试：")]),t._v(" "),s("p",[s("img",{staticClass:"lazy",attrs:{alt:"image","data-src":"https://cdn.staticaly.com/gh/brook-w/image-hosting@master/k8s/image.384sqabnry80.webp",loading:"lazy"}})]),t._v(" "),s("h4",{attrs:{id:"_2-利用-goland-进行代码调试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-利用-goland-进行代码调试"}},[t._v("#")]),t._v(" 2. 利用 "),s("code",[t._v("Goland")]),t._v(" 进行代码调试")]),t._v(" "),s("h4",{attrs:{id:"_3-利用-命令行-进行代码调试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-利用-命令行-进行代码调试"}},[t._v("#")]),t._v(" 3. 利用 "),s("code",[t._v("命令行")]),t._v(" 进行代码调试")]),t._v(" "),s("h5",{attrs:{id:"_1-以-dlv-方式启动-kube-apiserver-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-以-dlv-方式启动-kube-apiserver-2"}},[t._v("#")]),t._v(" 1. 以 dlv 方式启动 kube-apiserver")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" dlv "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--headless")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exec")]),t._v(" /home/xing/go/src/k8s.io/kubernetes/_output/local/bin/linux/amd64/kube-apiserver   --api-version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  -- --authorization-mode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Node,RBAC  --cloud-provider"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --cloud-config"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--v")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--vmodule")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --audit-policy-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-audit-policy-file --audit-log-path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-apiserver-audit.log --authorization-webhook-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --authentication-token-webhook-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --cert-dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes --egress-selector-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube_egress_selector_configuration.yaml --client-ca-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-ca.crt --kubelet-client-certificate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-kube-apiserver.crt --kubelet-client-key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-kube-apiserver.key --service-account-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-serviceaccount.key --service-account-lookup"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true --service-account-issuer"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://kubernetes.default.svc --service-account-jwks-uri"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://kubernetes.default.svc/openid/v1/jwks --service-account-signing-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/tmp/kube-serviceaccount.key --enable-admission-plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,Priority,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota,NodeRestriction --disable-admission-plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --admission-control-config-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" --bind-address"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),t._v(".0.0 --secure-port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6443")]),t._v(" --tls-cert-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/serving-kube-apiserver.crt --tls-private-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/serving-kube-apiserver.key --storage-backend"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("etcd3 --storage-media-type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("application/vnd.kubernetes.protobuf --etcd-servers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://127.0.0.1:2379 --service-cluster-ip-range"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.0")]),t._v(".0.0/24 --feature-gates"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("AllAlpha"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false --external-hostname"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("localhost --requestheader-username-headers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("X-Remote-User --requestheader-group-headers"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("X-Remote-Group --requestheader-extra-headers-prefix"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("X-Remote-Extra- --requestheader-client-ca-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/request-header-ca.crt --requestheader-allowed-names"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("system:auth-proxy --proxy-client-cert-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-auth-proxy.crt --proxy-client-key-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/run/kubernetes/client-auth-proxy.key --cors-allowed-origins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/127.0.0.1(:[0-9]+)?$,/localhost(:[0-9]+)?$"')]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注：如果指定了 --listen 就是你指定的 如果没有指定则随机生成一个端口 这里我是随机生成")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Outputs:\nAPI server listening at: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1:43605\n\n")])])]),s("h5",{attrs:{id:"_2-连接-dlv-connect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-连接-dlv-connect"}},[t._v("#")]),t._v(" 2. 连接 dlv connect")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("dlv connect localhost:43605\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在这里就可以调试了")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打断点")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("break")]),t._v(" cmd/kube-apiserver/apiserver.go:33\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Outputs:\nBreakpoint "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" at 0x5233854 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" main.main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cmd/kube-apiserver/apiserver.go:33\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("continue")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Outputs:\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" main.main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cmd/kube-apiserver/apiserver.go:33 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hits goroutine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(":1 total:1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PC: 0x5233854"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v(":         _ "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"k8s.io/component-base/metrics/prometheus/version"')]),t._v("  // "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" version metric registration\n    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),t._v(":         "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"k8s.io/kubernetes/cmd/kube-apiserver/app"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(": "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v(":\n    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v(": func "),s("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("33")]),t._v(":         "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" :"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app.NewAPIServerCommand"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("34")]),t._v(":         code :"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cli.Run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),t._v(":         os.Exit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("36")]),t._v(": "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("进行愉快的命令行调试就可以了")]),t._v(" "),s("h4",{attrs:{id:"_4-调试过程中注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-调试过程中注意事项"}},[t._v("#")]),t._v(" 4. 调试过程中注意事项")]),t._v(" "),s("h5",{attrs:{id:"_1-dlv"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-dlv"}},[t._v("#")]),t._v(" 1. dlv")]),t._v(" "),s("p",[t._v("在 dlv 启动参数一定要加 "),s("code",[t._v("--only-same-user=false")]),t._v(" 参数选项，否则会出现如下警告，导致远程或本地无法调试")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("closing connection from different user "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1:34980"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": connections to localhost are only accepted from the same UNIX user "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" security reasons\n")])])]),s("p",[t._v("大致意思就是仅允许当前启动 dlv app 的用户操作 debug，包括 "),s("code",[t._v("sudo")]),t._v(" 指令在内")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/golang/vscode-go/issues/810",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/golang/vscode-go/issues/810"),s("OutboundLink")],1)]),t._v(" "),s("h5",{attrs:{id:"_2-kube-apiserver-参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-kube-apiserver-参数"}},[t._v("#")]),t._v(" 2. kube-apiserver 参数")]),t._v(" "),s("p",[s("code",[t._v('--cors-allowed-origins="/127.0.0.1(:[0-9]+)?$,/localhost(:[0-9]+)?$"')]),t._v(" 参数选项使用了正则表达式，在此处要用 "),s("code",[t._v('""')]),t._v(" 包裹，否则会出现 bash 语法解析错误，无法识别 "),s("code",[t._v("(")]),t._v(" 之类的语法")])])}),[],!1,null,null,null);s.default=n.exports}}]);